(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){},27:function(e,t){},28:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4wQRFQwgzBdb6QAAAL9JREFUSMfNlssKwjAQRQ9S8IMEm/rNiv6TtO609QeumyxC6COPoZhVnucOA3MnCB6CQdBhNARO8BLcEPQCCSaBM4JPnvlEcBK8LUQi1iho5w6KRBbhCxeyRDbhNSLJ8JUHzgye87AYngKohq+BzOALhfMJ5qPgbFX6YdRZkR8SNY5AE6wbv2cS/UXwnUlRvXcJuijnrZl3zcEtbGUTXi2SAi+xlWx4iZPGcPcXvWCXbrYqskfTv3sR629LL7j+APJRXoh+oaytAAAAAElFTkSuQmCC"},29:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4wQRFQs7CTMEwgAAASNJREFUSMft1UFKw1AQxvH/PKFtUJJ4gZbiIQQXggupd+jW2IU9iRcobVMEb+BGcCGtC6EeJ+kidWHGhVGw0heSJrvOOvy+vJl5PNhXTkkdaGvqdRUdKbxJTfgc6ACR1Iingl6bqnBnfNxW9CXDFWS4Dlb3UhWems8F0M3w248gGlUyZBu+c0AeDnBQeqCh31FJrXjpE7RCv6OazvNwAGlM3AcRzkxKPxnE7yVW8WYdrGbbvjci9ICT1PDsjN3TKvHvAJU+SAJ4tpAMXxTBf2fQCo/OVc0TcAhEBq6SIF6W6fnWIf8JUWIj9JIgXu6C/9ui5tS7BB5BHSBSZCDoHdAu0hbrmm6066cK/7n1HmyElMbt+z7zL5pT77Uxcfv7d7nW+gJ2L6x+MkAiEwAAAABJRU5ErkJggg=="},30:function(e,t,a){e.exports=a(47)},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"getDevicesList",function(){return f}),a.d(n,"getDevice",function(){return g}),a.d(n,"getDeviceSnapshots",function(){return N}),a.d(n,"showCurrentDevice",function(){return D}),a.d(n,"refreshImage",function(){return y}),a.d(n,"killStream",function(){return _});var r={};a.r(r),a.d(r,"fetchUser",function(){return O});var s={};a.r(s),a.d(s,"runTest",function(){return Z}),a.d(s,"startTestAction",function(){return $}),a.d(s,"nextTest",function(){return ee}),a.d(s,"closeTestAction",function(){return te}),a.d(s,"resolveTestManually",function(){return ae});var c=a(0),o=a.n(c),l=a(23),i=a(8),u=a(3),d=a(4),p=a(6),m=a(5),h=a(7),b=a(11),v=a.n(b),E=(a(21),a(39),a(40),a(41),a(42),a(2));function f(){return{type:"GET_DEVICES_LIST",api:{url:"/api/devices",method:"GET"}}}function g(e,t){return{type:"GET_DEVICE",api:{url:"/api/device",method:"GET",data:{ip:e,port:t}}}}function N(e,t){return{type:"GET_DEVICE_SNAPSHOTS",api:{url:"/api/get_snapshots",method:"GET",data:{ip:e,port:t}}}}function D(){return{type:"HIDE_CURRENT_DEVICE"}}function y(e,t){return{type:"REFRESH_SNAPSHOT_IMAGE",api:{url:"/api/current_snapshot",method:"GET",data:{ip:e,port:t}}}}function _(e,t){return{type:"KILL_STREAM",api:{url:"/api/stop_stream",method:"GET",data:{ip:e,port:t}}}}function O(){return{type:"FETCH_USER",api:{url:"/api/user"}}}a(22);var A=function(e){var t=e.id,a=e.text,n=e.onClick,r=e.active,s=e.pending;return o.a.createElement("button",{key:t,type:"button",onClick:n,className:"list-group-item d-flex justify-content-between list-group-item-action".concat(r?" active":"")},a,s?o.a.createElement("div",{className:"typing_loader"}):null)},T=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.dashboardActions.getDevicesList()}},{key:"render",value:function(){var e=this,t=this.props.list.map(function(t,a){return o.a.createElement(A,{key:a,text:"".concat(t.ip,":").concat(t.port),onClick:function(){e.props.dashboardActions.getDevice(t.ip,t.port)},active:e.props.currentDevice.data.ip===t.ip&&e.props.currentDevice.data.port===t.port&&e.props.currentDevice.show,pending:e.props.currentDevice.data.ip===t.ip&&e.props.currentDevice.data.port===t.port&&e.props.currentDevice.pending})});return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"row mb-2"},o.a.createElement("div",{className:"col d-flex align-items-baseline justify-content-between"},o.a.createElement("span",{className:"h5 m-0"},"Devices",o.a.createElement("i",{className:"d-sm-inline-block d-md-none small align-middle material-icons ml-1","data-toggle":"collapse",href:"#collapseDevicesList",role:"button","aria-expanded":"false","aria-controls":"collapseDevicesList",style:{cursor:"pointer"}},"radio_button_checked")),this.props.devices.pending?o.a.createElement("div",{className:"typing_loader"}):o.a.createElement("span",{className:"m-0"},o.a.createElement("i",{className:"align-middle material-icons",style:{cursor:"pointer"},onClick:function(){e.props.dashboardActions.getDevicesList()}},"refresh")))),o.a.createElement("div",{className:"collapse show",id:"collapseDevicesList"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"},o.a.createElement("div",{className:"list-group"},t)))))}}]),t}(o.a.Component),S=Object(i.b)(function(e){return{list:e.dashboardReducer.list.devices,devices:e.dashboardReducer.list,currentDevice:e.dashboardReducer.currentDevice}},function(e){return{dashboardActions:Object(E.b)(n,e)}})(T),j=(a(43),function(e){return o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},"Device Information:"),o.a.createElement("div",{className:"card"},o.a.createElement("ul",{className:"list-group list-group-flush"},o.a.createElement("li",{className:"list-group-item"},"Address: ","".concat(e.currentDeviceData.ip,":").concat(e.currentDeviceData.port)),o.a.createElement("li",{className:"list-group-item"},"Manufacturer: ",e.currentDeviceData.Manufacturer),o.a.createElement("li",{className:"list-group-item"},"Model: ",e.currentDeviceData.Model),o.a.createElement("li",{className:"list-group-item"},"Firmware Version: ",e.currentDeviceData["Firmware Version"]),o.a.createElement("li",{className:"list-group-item"},"Serial Number: ",e.currentDeviceData["Serial Number"]),o.a.createElement("li",{className:"list-group-item"},"Hardware ID: ",e.currentDeviceData["Hardware ID"]))))}),R=a(10),I="http://onvif.auditory.ru",C=a(16),k=a.n(C),x=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={ip:e.ip,port:e.port,hls:new k.a,loaded:!1,supported:k.a.isSupported()},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.state.supported){var t=document.getElementById("".concat(this.state.ip).concat(this.state.port));console.log(t),this.state.hls.attachMedia(t),this.state.hls.loadSource("".concat(I,"/livestream?ip=").concat(this.state.ip,"&port=").concat(this.state.port)),this.state.hls.on(k.a.Events.MANIFEST_PARSED,function(){e.setState({loaded:!0}),t.play()})}}},{key:"componentWillUnmount",value:function(){!this.props.dontkill&&fetch("".concat(I,"/api/stop_stream?ip=").concat(this.state.ip,"&port=").concat(this.state.port)).then(function(){}).catch(function(){}),!this.props.dontkill&&this.state.hls.stopLoad()}},{key:"render",value:function(){var e=o.a.createElement("video",{controls:!0,className:"w-100",id:"".concat(this.state.ip).concat(this.state.port),style:{display:this.state.loaded?"block":"none"}}),t=this.props.spinner;return this.state.supported?o.a.createElement("div",{className:"position-relative"},e,this.state.loaded?null:t):o.a.createElement("p",null,"Stream is not supported on your device.")}}]),t}(o.a.Component);a(44),a(45);var w=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).togglePicture=function(){"snapshot"===a.state.tab?a.setState({tab:"stream"}):a.setState({tab:"snapshot"})},a.refreshImage=function(){a.setState({prevSnapshot:a.props.currentSnapshot&&a.props.currentSnapshot.url||a.state.prevSnapshot}),a.props.dashboardActions.refreshImage(a.props.currentDeviceData.ip,a.props.currentDeviceData.port)},a.state={tab:"snapshot",prevSnapshot:e.snapshot_url},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props.currentDeviceData.ip),console.log(this.props.currentDeviceData.port),this.props.dashboardActions.getDeviceSnapshots(this.props.currentDeviceData.ip,this.props.currentDeviceData.port),this.props.dashboardActions.refreshImage(this.props.currentDeviceData.ip,this.props.currentDeviceData.port),console.log(this.props)}},{key:"render",value:function(){var e,t,a=this,n=I+("snapshot"===this.state.tab?this.props.currentSnapshot&&this.props.currentSnapshot.url?this.props.currentSnapshot.url:this.state.prevSnapshot:this.props.stream_url);n=n+(~n.indexOf("?")?"&":"?")+"t=".concat(Date.now());var r=this.props.private_snapshot_url?!this.props.private_snapshot_url.includes("rtsp"):null,s=this.props.snapshotsList?this.props.snapshotsList.map(function(e,t){return o.a.createElement("div",{key:t,className:"carousel-item ".concat(0===t?"active":"")},o.a.createElement("img",{src:"".concat(I).concat(e.url),className:"d-block w-100",alt:"Snapshot".concat(t)}),o.a.createElement("div",{className:"carousel-caption"},o.a.createElement("h5",null,e.camera),o.a.createElement("p",null,e.datetime)))}):[],c=o.a.createElement("div",{className:"switch-wrapper"},"Show snapshot",o.a.createElement("label",{className:"switch"},o.a.createElement("input",{type:"checkbox",checked:"stream"===this.state.tab,onChange:this.togglePicture}),o.a.createElement("span",{className:"slider"})),"Show Stream"),l=o.a.createElement("div",{style:{top:0,pointerEvents:"none"},className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute"},o.a.createElement("div",{className:"spinner-border text-primary",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading..."))),i="snapshot"===this.state.tab?o.a.createElement("div",{className:"position-relative"},o.a.createElement("img",{src:n,alt:"snapshot",className:"stream-image",onClick:function(){a.refreshImage()}}),!this.props.currentSnapshot||this.props.currentSnapshot.pending?l:null):o.a.createElement(x,{spinner:l,ip:this.props.currentDeviceData.ip,port:this.props.currentDeviceData.port});return o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},"RTSP Stream:"),o.a.createElement("div",{className:"card snapshot-card"},o.a.createElement("div",{className:"row align-items-center"},o.a.createElement("div",{className:"col-sm-12 col-md-6"},c),o.a.createElement("div",{className:"col-sm-12 col-md-6"},o.a.createElement("div",null,o.a.createElement("button",(e={type:"button",className:"btn btn-sm mr-2 btn-secondary"},Object(R.a)(e,"type","button"),Object(R.a)(e,"data-toggle","collapse"),Object(R.a)(e,"data-target","#showRtspUrl"),Object(R.a)(e,"aria-expanded","false"),Object(R.a)(e,"aria-controls","showRtspUrl"),e),"RTSP Url"),o.a.createElement("button",(t={type:"button",className:"btn btn-sm mr-2 btn-secondary"},Object(R.a)(t,"type","button"),Object(R.a)(t,"data-toggle","collapse"),Object(R.a)(t,"data-target","#showSnapshotUrl"),Object(R.a)(t,"aria-expanded","false"),Object(R.a)(t,"aria-controls","showSnapshotUrl"),t),"Snapshot Url"),o.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary","data-toggle":"modal","data-target":".bd-slideshow-modal-lg"},"Slideshow")))),i),o.a.createElement("div",{className:"collapse",id:"showRtspUrl"},"RTSP avaliable at:",o.a.createElement("a",{href:this.props.private_stream_url}," "+this.props.private_stream_url)),o.a.createElement("div",{className:"collapse",id:"showSnapshotUrl"},this.props.private_snapshot_url&&r?"Snapshot avaliable at:":"Device does not support Snapshot or Snapshot Url content is not valid",this.props.private_snapshot_url&&r?o.a.createElement("a",{href:this.props.private_snapshot_url,target:"_blank",rel:"noopener noreferrer"}," "+this.props.private_snapshot_url):null),o.a.createElement("div",{className:"modal fade bd-slideshow-modal-lg",tabIndex:"-1",role:"dialog","aria-labelledby":"myLargeModalLabel","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog modal-lg"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{id:"carousel-slideshow",className:"carousel","data-ride":"carousel"},o.a.createElement("div",{className:"carousel-inner"},s),o.a.createElement("a",{className:"carousel-control-prev",href:"#carousel-slideshow",role:"button","data-slide":"prev"},o.a.createElement("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),o.a.createElement("span",{className:"sr-only"},"Previous")),o.a.createElement("a",{className:"carousel-control-next",href:"#carousel-slideshow",role:"button","data-slide":"next"},o.a.createElement("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),o.a.createElement("span",{className:"sr-only"},"Next")))))))}}]),t}(o.a.Component),L=Object(i.b)(function(e){return{currentSnapshot:e.dashboardReducer.currentDevice.currentSnapshot,snapshotsList:e.dashboardReducer.snapshotsList.snapshots}},function(e){return{dashboardActions:Object(E.b)(n,e)}})(w),P=function(e){return o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},"Settings(in development):"))},U=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={reports:[],isFetched:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(I,"/api/reports"),{method:"GET"}).then(function(e){return e.json()}).then(function(t){return e.setState({reports:t,isFetched:!0})})}},{key:"render",value:function(){var e=this.state.reports&&this.state.reports.filter(function(e){return e.device}).map(function(e,t){return o.a.createElement("tr",null,o.a.createElement("th",{scope:"row"},t+1),o.a.createElement("td",null,e.device&&e.device.ip),o.a.createElement("td",null,e.created),o.a.createElement("td",null,o.a.createElement("a",{className:"btn btn-primary",target:"_blank",href:"".concat(I,"/").concat(e.url)},"Download")))});return o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},"Previous reports:"),this.state.isFetched?this.state.reports.length?o.a.createElement("table",{className:"table table-bordered table-responsive-md"},o.a.createElement("tbody",null,e)):"No avaliable reports":o.a.createElement("div",{class:"spinner-border",role:"status"},o.a.createElement("span",{class:"sr-only"},"Loading...")))}}]),t}(o.a.Component),F=a(9),M=(a(46),a(25)),G=a(26),B=a.n(G),J=a(1),H={list:{devices:[],pending:!1,error:!1},currentDevice:{data:{},pending:!1,error:!1,show:!1,currentSnapshot:{url:null,pending:!1,error:!1}},snapshotsList:{snapshots:[],pending:!1,error:!1}};var V={tests:[],currIndex:0,done:!1,testInProgress:!1};var X={id:null,email:"",name:"",surname:"",image_url:"",register_date:""};var Q=a(27),W=a.n(Q),K=Object(E.c)({dashboardReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_DEVICES_LIST":if(t.data){var a={devices:t.data,pending:!1,error:!1};return Object(J.a)({},e,{list:a})}break;case"GET_DEVICES_LIST__PENDING":return Object(J.a)({},e,{currentDevice:{data:{},pending:!1,error:!1,show:!1},list:{devices:[],pending:!0,error:!1}});case"GET_DEVICES_LIST__ERROR":return Object(J.a)({},e,{list:{devices:[],pending:!1,error:!0}});case"GET_DEVICE":if(t.data){var n={data:t.data,pending:!1,error:!1,show:!0};return Object(J.a)({},e,{currentDevice:n})}break;case"GET_DEVICE__PENDING":var r={data:Object(J.a)({},t.api.data),pending:!0,error:!1,show:!1};return Object(J.a)({},e,{currentDevice:r});case"GET_DEVICE__ERROR":return Object(J.a)({},e,{currentDevice:{data:{},pending:!1,error:!0,show:!1}});case"GET_DEVICE_SNAPSHOTS":var s={snapshots:t.data,pending:!1,error:!1};return Object(J.a)({},e,{snapshotsList:s});case"GET_DEVICE_SNAPSHOTS__PENDING":var c={data:Object(J.a)({},t.api.data),pending:!0,error:!1};return Object(J.a)({},e,{snapshotsList:c});case"GET_DEVICE_SNAPSHOTS__ERROR":return Object(J.a)({},e,{snapshotsList:{data:{},pending:!1,error:!0}});case"HIDE_CURRENT_DEVICE":var o=Object(J.a)({},e.currentDevice,{show:!1});return Object(J.a)({},e,o);case"REFRESH_SNAPSHOT_IMAGE":var l={url:t.data.url,pending:!1,error:!1},i=Object(J.a)({},e.currentDevice,{currentSnapshot:l}),u=[].concat(Object(F.a)(e.snapshotsList.snapshots),[Object(J.a)({},t.data)]),d=Object(J.a)({},e.snapshotsList,{snapshots:u});return Object(J.a)({},e,{currentDevice:i,snapshotsList:d});case"REFRESH_SNAPSHOT_IMAGE__PENDING":var p=Object(J.a)({},e.currentDevice,{currentSnapshot:{url:null,pending:!0,error:!1}});return Object(J.a)({},e,{currentDevice:p});case"REFRESH_SNAPSHOT_IMAGE__ERROR":var m=Object(J.a)({},e.currentDevice,{currentSnapshot:{url:null,pending:!1,error:!0}});return Object(J.a)({},e,{currentDevice:m})}return e},testReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_TESTS":if(t.data){var a=t.data.map(function(e){return Object(J.a)({},e,{pending:!1,error:!1,data:{}})});return Object(J.a)({},e,{tests:a,done:!1,currIndex:0,testInProgress:!0})}return e;case"CLOSE_TEST":return Object(J.a)({},e,{currIndex:0,done:!1,testInProgress:!1});case"NEXT_TEST":return Object(J.a)({},e,{currIndex:e.currIndex+1});case"RUN_TEST":if(t.data){var n=Object(F.a)(e.tests),r=Object(J.a)({},n[e.currIndex],{pending:!1,error:!1,data:Object(J.a)({},t.data.response)});n[e.currIndex]=r;var s=~r.name.indexOf("Interactive")?e.currIndex:e.currIndex+1;return Object(J.a)({},e,{tests:n,currIndex:s,done:e.currIndex>=n.length-1})}return e;case"RUN_TEST__PENDING":var c=Object(F.a)(e.tests),o=Object(J.a)({},e.tests[e.currIndex],{pending:!0});return c.splice(e.currIndex,1,o),Object(J.a)({},e,{tests:c});case"RUN_TEST__ERROR":var l=Object(F.a)(e.tests),i=Object(J.a)({},e.tests[e.currIndex],{pending:!1,error:!0,data:Object(J.a)({},t.data.response)});l.splice(e.currIndex,1,i);var u=~i.name.indexOf("Interactive")?e.currIndex:e.currIndex+1;return Object(J.a)({},e,{tests:l,currIndex:u,done:e.currIndex>=l.length-1});case"RESOLVE_TEST_MANUALLY":if(!e.tests[t.data.index].pending){var d=Object(F.a)(e.tests),p=Object(J.a)({},e.tests[t.data.index].data.result,{supported:t.data.resolution}),m=Object(J.a)({},e.tests[t.data.index],{pending:!1,error:!1,data:Object(J.a)({},e.tests[t.data.index].data,{result:p})});return d.splice(t.data.index,1,m),Object(J.a)({},e,{tests:d})}return e;default:return e}},userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_USER":return Object(J.a)({},e,{pending:!1,error:!1},t.data);case"FETCH_USER__PENDING":return Object(J.a)({},e,{pending:!0,error:!1});case"FETCH_USER__ERROR":return Object(J.a)({},e,{error:!0,pending:!1});default:return e}},databaseReducer:W.a}),Y=function(e){var t=b.Deferred();return e.api.url=I+e.api.url,b.ajax(e.api).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()},z=function(e){return function(e){return function(t){var a=t.type;t.api?(Y(t).done(function(n){t.type=a,t.data=n,delete t.api,e(t)}).fail(function(n){t.type=a+"__ERROR",t.data=n,e(t)}),t.type=a+"__PENDING",e(t)):e(t)}}};var q=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],Object(E.d)(K,Object(E.a)(M.a,z,B.a))}();function Z(){var e=q.getState().testReducer,t=e.tests,a=e.currIndex,n=q.getState().dashboardReducer.currentDevice.data,r=n.ip,s=n.port,c=t[a];return{type:"RUN_TEST",api:{url:"/api/".concat(c.service,"_test/").concat(c.name,"?ip=").concat(r,"&port=").concat(s),method:"POST",data:{test_type:c.service,test_name:c.name,ip:r,port:s}}}}function $(e){return{type:"INIT_TESTS",data:Object(F.a)(e)}}function ee(){return{type:"NEXT_TEST"}}function te(){return{type:"CLOSE_TEST"}}function ae(e,t){return{type:"RESOLVE_TEST_MANUALLY",data:{resolution:e,index:t}}}var ne=function(e){var t=e.id,a=e.text,n=e.onClick;return o.a.createElement("button",{key:t,type:"button",onClick:n,className:"list-group-item d-flex justify-content-between list-group-item-action"},a)},re=function e(t){return t.reduce(function(t,a){return t.concat(Array.isArray(a)?e(a):a)},[])};var se=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={selected_test_type:null,left_column:[],right_column:[]},a.chooseTestType=function(e){var t=a.props.currentDeviceData.avaliable_tests.filter(function(t){return t.service===e.target.value}),n=t.length>0?t[0].available_tests:[];a.setState({selected_test_type:e.target.value,left_column:n.filter(function(t){return 0===a.state.right_column.filter(function(t){return t.name===t&&t.service===e.target.value}).length}).map(function(t){return{name:t,service:e.target.value}})})},a.startTest=function(e){a.props.testActions.startTestAction(e)},a.addToRightColumn=function(e,t){0===a.state.right_column.filter(function(a){return a.name===e&&a.service===t}).length&&a.setState({right_column:[{name:e,service:t}].concat(Object(F.a)(a.state.right_column))})},a.removeFromRightColumn=function(e,t){a.setState({right_column:a.state.right_column.filter(function(a){return!(a.name===e&&a.service===t)})})},a.getAddFullListBtn=function(){var e=a.props.currentDeviceData.avaliable_tests,t=re(e.map(function(e){return e.available_tests.map(function(t){return{name:t,service:e.service}})}));return o.a.createElement("button",{className:"ml-3 btn btn-primary",onClick:function(){a.setState({right_column:Object(F.a)(t)})}},"Add all ".concat(t.length," tests"))},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){b('[data-toggle="tooltip"]').tooltip({title:"<em>1.Select test <b><u>type</u></b>.</em> <br><em>2.Choose tests and add them into right column.<br>3.When Run button pressed, tests from the right column will be executed.<br> 4.Click on the test name to add or remove from the list.</em>",placement:"bottom"})}},{key:"render",value:function(){var e=this,t=this.props.currentDeviceData["Supported Services"].map(function(e,t){return o.a.createElement("option",{key:t,value:e},e)}),a=this.state.left_column.filter(function(t){return 0===e.state.right_column.filter(function(e){return e.name===t.name&&e.service===t.service}).length}).map(function(t,a){return o.a.createElement(ne,{key:a,text:"".concat(a+1,".").concat(t.name," (").concat(t.service,")"),onClick:function(){e.addToRightColumn(t.name,t.service)}})}),n=this.state.right_column.map(function(t,a){return o.a.createElement(ne,{key:a,text:"".concat(a+1,".").concat(t.name," (").concat(t.service,")"),onClick:function(){e.removeFromRightColumn(t.name,t.service)}})}),r=o.a.createElement("button",{className:"ml-3 btn btn-primary",onClick:function(){e.startTest(e.state.right_column)}},"Run ".concat(this.state.right_column.length," test").concat(1===this.state.right_column.length?"":"s")),s=o.a.createElement("button",{className:"ml-3 btn btn-secondary","data-toggle":"modal","data-target":"#aboutTest"},"About test"),c=a.length>0?o.a.createElement("button",{className:"mb-3 btn btn-success",onClick:function(){e.setState({right_column:[].concat(Object(F.a)(e.state.left_column),Object(F.a)(e.state.right_column))})}},"Add all to the right"):null,l=n.length>0?o.a.createElement("button",{className:"mb-3 btn btn-danger",onClick:function(){e.setState({right_column:[]})}},"Empty list"):null,i=this.getAddFullListBtn(),u=o.a.createElement("div",{className:"modal fade",id:"aboutTest",tabIndex:"-1",role:"dialog","aria-labelledby":"aboutTestTitle","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog modal-dialog-scrollable",role:"document"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-header"},o.a.createElement("h5",{className:"modal-title",id:"aboutTestTitle"},"Modal title"),o.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},o.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),o.a.createElement("div",{className:"modal-body"},"..."),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal"},"Close")))));return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"card-body"},o.a.createElement("div",{className:"row mb-2"},o.a.createElement("div",{className:"col d-flex"},o.a.createElement("span",{className:"h5 m-0"},o.a.createElement("h5",{className:"card-title"},"Device Test:")),o.a.createElement("span",{className:"ml-1"},o.a.createElement("i",{className:"align-middle material-icons","data-toggle":"tooltip","data-placement":"bottom","data-html":"true",style:{cursor:"pointer"},"data-animation":"true"},"info")))),o.a.createElement("div",{className:"form-inline"},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"my-1 mr-2",htmlFor:"selectTestDropdown"},"Test type:"),o.a.createElement("select",{id:"selectTestDropdown",value:this.state.selected_test_type?this.state.selected_test_type:"",className:"form-control",onChange:this.chooseTestType},o.a.createElement("option",{value:"not selected"},"not selected"),t)),o.a.createElement("div",{className:"form-group d-flex justify-content-between"},s,u,i,r))),o.a.createElement("div",{className:"card-body"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"},c,o.a.createElement("div",{className:this.state.selected_test_type&&"not selected"!==this.state.selected_test_type?"list-group pre-scrollable":"list-group"},a)),o.a.createElement("div",{className:"col"},l,o.a.createElement("div",{className:this.state.selected_test_type&&"not selected"!==this.state.selected_test_type?"list-group pre-scrollable":"list-group"},n)))))}}]),t}(c.Component),ce=Object(i.b)(null,function(e){return{testActions:Object(E.b)(s,e)}})(se);var oe=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={currentTab:"testing"},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=null;return"info"===this.state.currentTab&&(t=o.a.createElement(j,{currentDeviceData:this.props.currentDeviceData})),"stream"===this.state.currentTab&&(t=o.a.createElement(L,{snapshot_url:this.props.currentDeviceData.snapshot_url,private_snapshot_url:this.props.currentDeviceData.private_snapshot_url,stream_url:this.props.currentDeviceData.stream_url,private_stream_url:this.props.currentDeviceData.private_stream_url,currentDeviceData:this.props.currentDeviceData})),"testing"===this.state.currentTab&&(t=o.a.createElement(ce,{currentDeviceData:this.props.currentDeviceData})),"settings"===this.state.currentTab&&(t=o.a.createElement(P,{currentDeviceData:this.props.currentDeviceData})),"database"===this.state.currentTab&&(t=o.a.createElement(U,{currentDeviceData:this.props.currentDeviceData})),this.props.currentDevice.show?o.a.createElement("div",{className:"card text-left"},o.a.createElement("div",{className:"card-header"},o.a.createElement("ul",{className:"nav nav-pills card-header-tabs"},o.a.createElement("li",{className:"nav-item"},o.a.createElement("a",{className:"nav-link ".concat("info"===this.state.currentTab?"active":""),onClick:function(){e.setState({currentTab:"info"})},href:"#"},"Information")),o.a.createElement("li",{className:"nav-item"},o.a.createElement("a",{className:"nav-link ".concat("stream"===this.state.currentTab?"active":""),onClick:function(){e.setState({currentTab:"stream"})},href:"#"},"Stream")),o.a.createElement("li",{className:"nav-item"},o.a.createElement("a",{className:"nav-link ".concat("testing"===this.state.currentTab?"active":""),onClick:function(){e.setState({currentTab:"testing"})},href:"#"},"Testing")),o.a.createElement("li",{className:"nav-item"},o.a.createElement("a",{className:"nav-link ".concat("settings"===this.state.currentTab?"active":""),onClick:function(){e.setState({currentTab:"settings"})},href:"#"},"Settings")),o.a.createElement("li",{className:"nav-item"},o.a.createElement("a",{className:"nav-link ".concat("database"===this.state.currentTab?"active":""),onClick:function(){e.setState({currentTab:"database"})},href:"#"},"Database")))),t):o.a.createElement("div",{className:"card text-center"},o.a.createElement("div",{className:"card-body d-flex align-items-center justify-content-center"},o.a.createElement("h4",{className:"card-title text-center mb-0"},this.props.currentDevice.pending||this.props.list.pending?"Loading...":"Choose device from the list"),this.props.currentDevice.pending||this.props.list.pending?o.a.createElement("div",{className:"loader"}):null))}}]),t}(o.a.Component),le=Object(i.b)(function(e){return{list:e.dashboardReducer.list,currentDevice:e.dashboardReducer.currentDevice,currentDeviceData:e.dashboardReducer.currentDevice.data}},function(e){return{dashboardActions:Object(E.b)(n,e)}})(oe);var ie=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.userActions.fetchUser()}},{key:"render",value:function(){return o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-12 col-md-3  mb-3"},o.a.createElement(S,null)),o.a.createElement("div",{className:"col-sm-12 col-md-9"},o.a.createElement(le,null)))}}]),t}(o.a.Component),ue=Object(i.b)(function(e){return{dashboard:e.dashboardReducer.list,currentDevice:e.dashboardReducer.currentDevice}},function(e){return{dashboardActions:Object(E.b)(n,e),userActions:Object(E.b)(r,e)}})(ie),de=function(e){return o.a.createElement("nav",{className:"navbar navbar-dark bg-primary mb-3"},o.a.createElement("a",{className:"navbar-brand",href:"#"},"ONVIF Compliance Tester"),o.a.createElement("ul",{className:"navbar-nav mr-auto"}),o.a.createElement("div",{className:"form-inline my-2 my-lg-0 mr-5"},o.a.createElement("p",{className:"mb-0 mr-3 text-light"},"".concat(e.user.name," ").concat(e.user.surname)),o.a.createElement("a",{className:"text-light",href:"/logout"},"Logout")))},pe=function(e){var t=e.testResponse.reduce(function(e,t){return e[t.service]=e[t.service]||[],e[t.service].push(t),e},{}),a=Object.keys(t).sort().map(function(e,a){return o.a.createElement(o.a.Fragment,{key:a},o.a.createElement("p",null,o.a.createElement("b",null,(n=e).charAt(0).toUpperCase()+n.slice(1),":")),o.a.createElement("table",{className:"table table-bordered table-responsive-md"},o.a.createElement("tbody",null,t[e].map(function(e,t){return o.a.createElement("tr",{className:"row m-0",key:t},e.data.result?o.a.createElement("th",{className:"col-1",scope:"row"},t+1):null,e.data.result?o.a.createElement("td",{className:"col-5"},e.data.result.report_name):null,e.data.result?o.a.createElement("td",{className:"col-6 ".concat(e.data.result.supported?"text-success":"text-danger")},e.data.result.supported?"Supported":"Not supported",e.data.result.report?o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:"ml-3 btn btn-secondary btn-sm","data-toggle":"collapse","data-target":"#features".concat(t)},"View"),o.a.createElement("div",{id:"features".concat(t),className:"collapse"},e.data.result.report.split("\n").map(function(e,t){return o.a.createElement("p",{style:{lineHeight:"20px"},className:"text-dark mt-2",key:t},e)}))):null):null)}))));var n});return o.a.createElement(o.a.Fragment,null,a)},me=a(28),he=a.n(me),be=a(29),ve=a.n(be),Ee=function(e){return o.a.createElement("div",{className:"modal fade",id:e.id,tabIndex:"-1",role:"dialog"},o.a.createElement("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",role:"document"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-header"},o.a.createElement("h5",{className:"modal-title",onClick:function(){e.onClose&&e.onClose()}},"".concat(e.title)),o.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},o.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),o.a.createElement("div",{className:"modal-body"},o.a.createElement(x,{dontkill:!0,ip:e.ip,port:e.port})),o.a.createElement("div",{className:"modal-footer"},e.testIsDone&&o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){e.onTestFailed&&e.onTestFailed()}},"Failed"),o.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){e.onTestPassed&&e.onTestPassed()}},"Passed")),e.testInProgress&&!e.testIsDone?o.a.createElement("span",null,"Test in progress..."):null,e.testInProgress||e.testIsDone?null:o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){e.onStart&&e.onStart()}},"Start the test")))))};var fe=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).toggleChange=function(){a.setState({printResponses:!a.state.printResponses})},a.handleDownload=function(e){a.setState({isReportReady:e})},a.downloadReport=function(){a.handleDownload(!0);var e=Object(J.a)({},a.props.currentDevice),t=a.props.testsList.filter(function(e){return!e.pending&&!e.error}).reduce(function(e,t){return e[t.service]=e[t.service]||[],e[t.service].push(t),e},{}),n={camInfo:Object(J.a)({},e),runnedTests:Object(J.a)({},t),printResponses:a.state.printResponses};console.log(n),fetch("".concat(I,"/api/report"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(e){return e.json()}).then(function(e){window.open("".concat(I,"/").concat(e.response),"_blank"),a.handleDownload(!1)})},a.returnBack=function(){fetch("".concat(I,"/api/stop_stream?ip=").concat(a.props.currentDevice.ip,"&port=").concat(a.props.currentDevice.port)).then(function(){}).catch(function(){}),a.props.testActions.closeTestAction()},a.state={isReportReady:!1,printResponses:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.runTest()}},{key:"componentDidUpdate",value:function(){this.runTest()}},{key:"runTest",value:function(){var e=this.props.testsList[this.props.currTestIndex];this.props.testsDone||!e||e.pending||0!==Object.entries(e.data).length||this.state.showModal||(~e.name.indexOf("Interactive")?v()("#streamModal").modal("show"):(v()("#streamModal").modal("hide"),this.props.testActions.runTest()))}},{key:"resolveTestManually",value:function(e,t){this.props.testActions.nextTest(),this.props.testActions.resolveTestManually(e,t)}},{key:"render",value:function(){var e=this,t=this.state.isReportReady?o.a.createElement("button",{className:"ml-3 btn btn-primary",type:"button",disabled:!0},o.a.createElement("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"    Loading..."):o.a.createElement("button",{className:"ml-3 btn btn-primary",onClick:function(){e.downloadReport()}},"Download Report"),a=o.a.createElement("button",{className:"ml-3 btn btn-primary",onClick:function(){e.returnBack()}},"Back"),n=this.props.testsList.map(function(e,t){return o.a.createElement("div",{className:"card",key:t},o.a.createElement("div",{className:"card-header",id:"heading".concat(t)},o.a.createElement("h5",{className:"mb-0 d-flex justify-content-between align-items-center"},o.a.createElement("button",{className:"btn btn-link",style:{color:"black"},"data-toggle":"collapse","data-target":"#collapse".concat(t),"aria-expanded":"true","aria-controls":"#collapse".concat(t)},e.name," (",e.service,")"),o.a.createElement("div",{className:"d-inline-block"},e.pending?o.a.createElement("div",{className:"typing_loader"}):null,e.error?o.a.createElement("img",{src:he.a,alt:"error"}):null,e.data.result?o.a.createElement("img",{src:ve.a}):null))),o.a.createElement("div",{id:"collapse".concat(t),className:"collapse","aria-labelledby":"#heading".concat(t),"data-parent":"#accordion"},o.a.createElement("div",{className:"card-body"},e.data.result?o.a.createElement("p",null,e.data.result.supported?"".concat(e.name," is supported"):"".concat(e.name," is not supported")):null,e.data.result?o.a.createElement("p",null,e.data.result.extension?"Test Feature: ".concat(e.data.result.extension):null):null,e.data.result?o.a.createElement("pre",null,e.data.result.response?"Response: ".concat(e.data.result.response):null):null)))}),r=this.props.testsList[this.props.currTestIndex],s=this.props.currTestIndex,c=r?r.name:"N/A",l=r&&r.pending,i=r&&0!==Object.entries(r.data).length;return o.a.createElement(o.a.Fragment,null,o.a.createElement("h5",null,"Report:"),o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},o.a.createElement("button",{className:"m-1 btn btn-primary","data-toggle":"collapse","data-target":"#summary"},"Summary"),o.a.createElement("div",{id:"summary",className:"m-2 collapse"},o.a.createElement(pe,{testResponse:this.props.testsList})),o.a.createElement("div",{id:"accordion"},n),o.a.createElement("div",{className:"form-group d-flex justify-content-end mt-4"},o.a.createElement("div",{className:"form-check"},o.a.createElement("input",{type:"checkbox",checked:this.state.printResponses,onChange:function(){e.toggleChange()},className:"form-check-input",id:"exampleCheck1"}),o.a.createElement("label",{className:"form-check-label",for:"exampleCheck1"},"Include responses in report")),t,a))),o.a.createElement(Ee,{id:"streamModal",title:c,ip:this.props.currentDevice.ip,port:this.props.currentDevice.port,testInProgress:l,testIsDone:i,onStart:function(){e.props.testActions.runTest()},onClose:function(){e.props.testActions.nextTest()},onTestFailed:function(){e.resolveTestManually(!1,s)},onTestPassed:function(){e.resolveTestManually(!0,s)}}))}}]),t}(c.Component),ge=Object(i.b)(function(e){return{currentDevice:e.dashboardReducer.currentDevice.data,testsList:e.testReducer.tests,testsFetched:e.testReducer.testInProgress,testsDone:e.testReducer.done,currTestIndex:e.testReducer.currIndex}},function(e){return{testActions:Object(E.b)(s,e)}})(fe);var Ne=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(de,{user:this.props.user}),o.a.createElement("div",{className:"container"},this.props.testInProgress?o.a.createElement(ge,null):o.a.createElement(ue,null)))}}]),t}(c.Component),De=Object(i.b)(function(e){return{testInProgress:e.testReducer.testInProgress,user:e.userReducer}},null)(Ne);Object(l.render)(o.a.createElement(i.a,{store:q},o.a.createElement(De,null)),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.cc512353.chunk.js.map